#!/usr/bin/env node

var opt     = require('optimist'),
    options = require('../lib/options'),
    browser = require('../lib/browser'),
    grep    = require('../lib/grep'),
    cli     = require('../lib/cli');

var argv = opt
      .options('browser', { alias: 'b' })
      .options('visit', { alias: 'bv' })
      .options('inc', { alias: 'i' })
      .options('grep', { alias: 'g' })
      .options('port', { alias: 'p' })
      .options('timeout', { alias: 't' })
      .options('version', { alias: 'v' })
      .options('help', { alias: 'h' })
      .argv;

if (argv.help) require('show-help');
if (argv.version && !argv.browser) require('show-version');

if (argv.inc) browser.include(argv.inc);
if (argv.port) options.port(argv.port);
if (argv.timeout) options.timeout(argv.timeout);
if (argv.grep) grep.pattern(argv.grep);

if(argv.browser && argv.version) argv.visit = true;
if(argv.visit) argv.browser = true;

( argv.browser ? browser : cli )(argv);
